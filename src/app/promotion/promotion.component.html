
<div class="content">
<div class="row">
  <div class="col-md-8">
    <mat-card class="promotion-card">
      <mat-card-title>โปรโมชั่นแนะนำจากดอกไม้ที่ใกล้หมดอายุ</mat-card-title>
      
      <table mat-table id="promotion_suggest" class="mat-elevation-z8" [dataSource]="dataSourceNormal">
        
        <ng-container matColumnDef="flowername">
          <th mat-header-cell *matHeaderCellDef> ชื่อช่อดอกไม้ </th>
          <td mat-cell *matCellDef="let promotionDetailLogsNormal"> {{promotionDetailLogsNormal.flowerFormula.name}} </td> 
        </ng-container>
        
        <ng-container matColumnDef="size">
        <th mat-header-cell *matHeaderCellDef> ขนาด </th>
          <td mat-cell *matCellDef="let promotionDetailLogsNormal"> {{promotionDetailLogsNormal.flowerFormula.size}} </td>
        </ng-container>
        
        <ng-container matColumnDef="unit">
          <th mat-header-cell *matHeaderCellDef> จำนวนช่อ </th> 
          <td mat-cell *matCellDef="let promotionDetailLogsNormal"> {{promotionDetailLogsNormal.quantity}} </td>
        </ng-container>

        <ng-container matColumnDef="profit">
          <th mat-header-cell *matHeaderCellDef> กำไร </th>
          <td mat-cell *matCellDef="let promotionDetailLogsNormal"> {{promotionDetailLogsNormal.profit}} </td>
        </ng-container>

        <ng-container matColumnDef="totalprofit">
          <th mat-header-cell *matHeaderCellDef> กำไรรวม </th>
          <td mat-cell *matCellDef="let promotionDetailLogsNormal">  {{calculateTotalProfit(promotionDetailLogsNormal.profit, promotionDetailLogsNormal.quantity)}} <td>
        </ng-container>

        <ng-container matColumnDef="price">
          <th mat-header-cell *matHeaderCellDef> ราคาขาย </th>
          <td mat-cell *matCellDef="let promotionDetailLogsNormal"> {{promotionDetailLogsNormal.price}} </td>
        </ng-container>

        <!--{{promotionDetailLogsNormal.lotStock}} -->
        <ng-container matColumnDef="lot">
          <th mat-header-cell *matHeaderCellDef> lot </th>
          <td mat-cell *matCellDef="let promotionDetailLogsNormal"> {{setFormatDateLotStock(promotionDetailLogsNormal.lotStock)}} </td>
        </ng-container>
      
        <ng-container matColumnDef="location">
          <th mat-header-cell *matHeaderCellDef> สถานที่ </th>
          <td mat-cell *matCellDef="let promotionDetailLogsNormal"> {{promotionDetailLogsNormal.florist.name}} </td>
        </ng-container>

        <ng-container matColumnDef="imageUrl">
            <th mat-header-cell *matHeaderCellDef></th>
            <td mat-cell *matCellDef="let promotionDetailLogsNormal">
              <img class="flower" src={{promotionDetailLogsNormal.flowerFormula.imagePath}}/>
            </td>
        </ng-container>

        <ng-container matColumnDef="add">
          <th mat-header-cell *matHeaderCellDef></th>
          <td mat-cell *matCellDef="let promotionDetailLogsNormal">
            <button mat-mini-fab color="accent" aria-label="Example icon button with a plus one icon"
                    (click)="openDialogReplaceFlower(promotionDetailLogsNormal.flowerFormula.imagePath,
                    promotionDetailLogsNormal.size,
                    promotionDetailLogsNormal.price,
                    promotionDetailLogsNormal.flowerFormula.name,
                    promotionDetailLogsNormal.quantity,
                    promotionDetailLogsNormal.florist.name,
                    promotionDetailLogsNormal.profit,
                    cntPromotion)" >
              <mat-icon>forward</mat-icon>
            </button>
          </td>
        </ng-container>
        <tr mat-header-row *matHeaderRowDef="displayedColumnsNormal"></tr>
        <tr mat-row *matRowDef="let row; columns: displayedColumnsNormal;"></tr>
      </table>

      <!--
      <table mat-table id="promotion_suggest" class="mat-elevation-z8" [dataSource]="dataSourceNormal">
        
        <ng-container matColumnDef="flowername">
          <th mat-header-cell *matHeaderCellDef> ชื่อช่อดอกไม้ </th>
          <td mat-cell *matCellDef="let promotionDetails"> {{promotionDetails.flowerFormula.name}} </td> 
        </ng-container>
        
        <ng-container matColumnDef="size">
        <th mat-header-cell *matHeaderCellDef> ขนาด </th>
          <td mat-cell *matCellDef="let promotionDetails"> {{promotionDetails.flowerFormula.size}} </td>
        </ng-container>
        
        <ng-container matColumnDef="unit">
          <th mat-header-cell *matHeaderCellDef> จำนวนช่อ </th> 
          <td mat-cell *matCellDef="let promotionDetails"> {{promotionDetails.quantity}} </td>
        </ng-container>

        <ng-container matColumnDef="profit">
          <th mat-header-cell *matHeaderCellDef> กำไร </th>
          <td mat-cell *matCellDef="let promotionDetails"> {{promotionDetails.profit}} </td>
        </ng-container>

        <ng-container matColumnDef="totalprofit">
          <th mat-header-cell *matHeaderCellDef> กำไรรวม </th>
          <td mat-cell *matCellDef="let promotionDetails">  {{calculateTotalProfit(promotionDetails.profit, promotionDetails.quantity)}} <td>
        </ng-container>

        <ng-container matColumnDef="price">
          <th mat-header-cell *matHeaderCellDef> ราคาขาย </th>
          <td mat-cell *matCellDef="let promotionDetails"> {{promotionDetails.price}} </td>
        </ng-container>
      
        <ng-container matColumnDef="location">
          <th mat-header-cell *matHeaderCellDef> สถานที่ </th>
          <td mat-cell *matCellDef="let promotionDetails"> {{promotionDetails.florist.name}} </td>
        </ng-container>

        <ng-container matColumnDef="imageUrl">
            <th mat-header-cell *matHeaderCellDef></th>
            <td mat-cell *matCellDef="let promotionDetails">
              <img class="flower" src={{promotionDetails.flowerFormula.imagePath}}/>
            </td>
        </ng-container>

        <ng-container matColumnDef="add">
          <th mat-header-cell *matHeaderCellDef></th>
          <td mat-cell *matCellDef="let promotionDetails">
            <button mat-mini-fab color="accent" aria-label="Example icon button with a plus one icon"
                    (click)="openDialogReplaceFlower(promotionDetails.flowerFormula.imagePath,
                    promotionDetails.size,
                    promotionDetails.price,
                    promotionDetails.flowerFormula.name,
                    promotionDetails.quantity,
                    promotionDetails.florist.name,
                    promotionDetails.profit,
                    cntPromotion)" >
              <mat-icon>forward</mat-icon>
            </button>
          </td>
        </ng-container>
        <tr mat-header-row *matHeaderRowDef="displayedColumnsNormal"></tr>
        <tr mat-row *matRowDef="let row; columns: displayedColumnsNormal;"></tr>
      </table>
      -->

      <p></p>
        <mat-card-title>โปรโมชั่นแนะนำจากดอกไม้ในสต๊อก</mat-card-title>
        
        <table mat-table id="promotion_suggest" class="mat-elevation-z8" [dataSource]="dataSourceNormalCurrentDto">
        
          <ng-container matColumnDef="flowername">
            <th mat-header-cell *matHeaderCellDef> ชื่อช่อดอกไม้ </th>
            <td mat-cell *matCellDef="let promotionDetailLogsCurrent"> {{promotionDetailLogsCurrent.flowerFormula.name}} </td> 
          </ng-container>
          
          <ng-container matColumnDef="size">
          <th mat-header-cell *matHeaderCellDef> ขนาด </th>
            <td mat-cell *matCellDef="let promotionDetailLogsCurrent"> {{promotionDetailLogsCurrent.flowerFormula.size}} </td>
          </ng-container>
          
          <ng-container matColumnDef="unit">
            <th mat-header-cell *matHeaderCellDef> จำนวนช่อ </th> 
            <td mat-cell *matCellDef="let promotionDetailLogsCurrent"> {{promotionDetailLogsCurrent.quantity}} </td>
          </ng-container>
  
          <ng-container matColumnDef="profit">
            <th mat-header-cell *matHeaderCellDef> กำไร </th>
            <td mat-cell *matCellDef="let promotionDetailLogsCurrent"> {{promotionDetailLogsCurrent.profit}} </td>
          </ng-container>
  
          <ng-container matColumnDef="totalprofit">
            <th mat-header-cell *matHeaderCellDef> กำไรรวม </th>
            <td mat-cell *matCellDef="let promotionDetailLogsCurrent"> {{calculateTotalProfit(promotionDetailLogsCurrent.profit, promotionDetailLogsCurrent.quantity)}} <td>
          </ng-container>
  
          <ng-container matColumnDef="price">
            <th mat-header-cell *matHeaderCellDef> ราคาขาย </th>
            <td mat-cell *matCellDef="let promotionDetailLogsCurrent"> {{promotionDetailLogsCurrent.price}} </td>
          </ng-container>

          <ng-container matColumnDef="lot">
            <th mat-header-cell *matHeaderCellDef> lot </th>
            <td mat-cell *matCellDef="let promotionDetailLogsCurrent"> {{setFormatDateLotStock(promotionDetailLogsCurrent.lotStock)}} </td>
          </ng-container>
        
          <ng-container matColumnDef="location">
            <th mat-header-cell *matHeaderCellDef> สถานที่ </th>
            <td mat-cell *matCellDef="let promotionDetailLogsCurrent"> {{promotionDetailLogsCurrent.florist.name}}  </td>
          </ng-container>
  
          <ng-container matColumnDef="imageUrl">
              <th mat-header-cell *matHeaderCellDef></th>
              <td mat-cell *matCellDef="let promotionDetailLogsCurrent">
                <img class="flower" src={{promotionDetailLogsCurrent.flowerFormula.imagePath}}/>
              </td>
          </ng-container>
  
          <ng-container matColumnDef="add">
            <th mat-header-cell *matHeaderCellDef></th>
            <td mat-cell *matCellDef="let promotionDetailLogsCurrent">
              <button mat-mini-fab color="accent" aria-label="Example icon button with a plus one icon"
                      (click)="openDialogReplaceFlower(promotionDetailLogsCurrent.flowerFormula.imagePath,
                      promotionDetailLogsCurrent.size,
                      promotionDetailLogsCurrent.price,
                      promotionDetailLogsCurrent.flowerFormula.name,
                      promotionDetailLogsCurrent.quantity,
                      promotionDetailLogsCurrent.florist.name,
                      promotionDetailLogsCurrent.profit,
                      cntPromotion)" >
                <mat-icon>forward</mat-icon>
              </button>
            </td>
          </ng-container>
  
          <tr mat-header-row *matHeaderRowDef="displayedColumnsNormalCurrentDto"></tr>
          <tr mat-row *matRowDef="let row; columns: displayedColumnsNormalCurrentDto;"></tr>
        </table>

      </mat-card>
      <p></p>
    </div>
    
      
    <!-- current promotion -->
    <div class="col-md-4">
    <div>
      <mat-card class="current-card">
        <mat-card-title>โปรโมชั่นปัจจุบัน</mat-card-title>
        <mat-card-subtitle>เลือกโปรโมชั่นได้สูงสุด 4 โปรโมชั่น</mat-card-subtitle>
          <div fxLayout="row wrap" fxLayoutGap="5px grid">
            <div fxFlex="50%" fxFlex.xs="100%" fxFlex.sm="25%" *ngFor="let promotionDetail of promotionDetails">
                <mat-card class="mat-elevation-z4" >
                    <mat-card-content>{{promotionDetail.flowerFormula.name}}</mat-card-content>
                    <img class="main-image" mat-card-image src={{promotionDetail.flowerFormula.imagePath}}>
                    <mat-card-content>
                        <div>ขนาด : {{promotionDetail.flowerFormula.size}}</div> 
                        <div>จำนวนช่อ : {{promotionDetail.quantity}}</div>
                        <div>ราคาขาย : {{promotionDetail.price}}</div>
                        <div>กำไร : {{promotionDetail.profit}}</div>
                        <!-- <div>กำไรรวม : {{promotionDetail.profit}}</div> -->
                        <div>กำไรรวม : {{calculateTotalProfit(promotionDetail.profit, promotionDetail.quantity)}}</div>
                        <div>สถานที่   : {{promotionDetail.florist.locationName}}</div>
                    </mat-card-content>
                    <mat-card-actions>
                        <button mat-mini-fab color="primary">
                          <mat-icon>facebook</mat-icon>
                        </button>  
                        <button mat-mini-fab color="warn">
                          IG
                        </button>
                        <button mat-mini-fab color="basic" (click)="getIdFlowerReplace(promotionDetail.id)">
                          <mat-icon>delete</mat-icon>
                        </button>   
                    </mat-card-actions>
                </mat-card>
            </div>
          </div>     
          
        <p></p>
        <button mat-flat-button color="primary">
            แชร์
        </button> 
      </mat-card>
    </div>
  </div>
</div>
</div>